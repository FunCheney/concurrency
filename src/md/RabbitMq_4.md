## RabbitMq 问题

**1.如何保证消息消费的幂等性？**

方案一：消息发送时更具业务信息生成一个全局的唯一ID，在消息落库的时候，根据唯一索引来处理。

方案二: 消费消息的时候，利用redis来做处理，使消息只消费一次。

**2.消息丢失，该如何解决？**

场景：

&ensp;&ensp; 生产者投递消息时消息丢失

解决方案：

一、选择RabbitMq提供的事物。但是开启事物后会严重影响性能，降低系统的吞吐量。

二、使用confirm模式(确保信息的可靠性投递)。

&ensp;&ensp;1.生产者投递消息后，消费者还没消费，RabbitMq出现问题了

解决方案：

&ensp;&ensp;2.RabbitMQ将接收到的消息持久化到磁盘上去。消息的持久化主要有两个步骤：

* 1.创建queue的时候将其设置为持久化，这样可以确保rabbitmq持久化queue的元数据，但是不会持久化queue里的数据。

* 2.发送消息的时候将消息的deliveryMode设置为2，就是将消息设置为持久化的，此时RabbitMq就会将消息持久化到磁盘上去。



&ensp;&ensp;3.消费者消费消息时消费丢失

解决方案：

&ensp;&ensp；取消消费端auto_ack采用自己手动ack的模式。


**3.如何保证消息的顺序性？**


**4.消费端出问题，如何解决？**

&ensp;&ensp;消息的消费者出问题，首先可能会导致消息在消息队列里面积压，没有被消费掉。

解决方案：

&ensp;&ensp;1.



